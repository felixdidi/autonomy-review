<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Felix Dietrich &amp; Leonard Reinecke">
<meta name="dcterms.date" content="2023-03-10">

<title>Topic Modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Topic Modeling</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">General</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Analyses</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./get_data.html" class="sidebar-item-text sidebar-link">Get Papers</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preprocess.html" class="sidebar-item-text sidebar-link">Preprocessing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tm.html" class="sidebar-item-text sidebar-link active">Topic Modeling</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Abstracts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_1-100.html" class="sidebar-item-text sidebar-link">1-100</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_101-200.html" class="sidebar-item-text sidebar-link">101-200</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_201-300.html" class="sidebar-item-text sidebar-link">201-300</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_301-400.html" class="sidebar-item-text sidebar-link">301-400</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_401-500.html" class="sidebar-item-text sidebar-link">401-500</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_501-600.html" class="sidebar-item-text sidebar-link">501-600</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_601-700.html" class="sidebar-item-text sidebar-link">601-700</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_701-800.html" class="sidebar-item-text sidebar-link">701-800</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_801-900.html" class="sidebar-item-text sidebar-link">801-900</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_901-1000.html" class="sidebar-item-text sidebar-link">901-1000</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_1001-1100.html" class="sidebar-item-text sidebar-link">1001-1100</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_1101-1200.html" class="sidebar-item-text sidebar-link">1101-1200</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_1201-1300.html" class="sidebar-item-text sidebar-link">1201-1300</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_1301-1400.html" class="sidebar-item-text sidebar-link">1301-1400</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_1401-1500.html" class="sidebar-item-text sidebar-link">1401-1500</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_1501-1600.html" class="sidebar-item-text sidebar-link">1501-1600</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_1601-1700.html" class="sidebar-item-text sidebar-link">1601-1700</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_1701-1744.html" class="sidebar-item-text sidebar-link">1701-1744</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abstracts/abstracts_AI.html" class="sidebar-item-text sidebar-link">AI</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-data" id="toc-load-data" class="nav-link active" data-scroll-target="#load-data">Load Data</a></li>
  <li><a href="#lemmatise" id="toc-lemmatise" class="nav-link" data-scroll-target="#lemmatise">Lemmatise</a></li>
  <li><a href="#further-cleaning" id="toc-further-cleaning" class="nav-link" data-scroll-target="#further-cleaning">Further Cleaning</a></li>
  <li><a href="#topic-model" id="toc-topic-model" class="nav-link" data-scroll-target="#topic-model">Topic Model</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model Diagnostics</a></li>
  <li><a href="#inspect-model" id="toc-inspect-model" class="nav-link" data-scroll-target="#inspect-model">Inspect Model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">Topic Modeling</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Autonomy</div>
    <div class="quarto-category">Digital Media</div>
    <div class="quarto-category">Self-Determination</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Felix Dietrich &amp; Leonard Reinecke </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 10, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># libs</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(udpipe)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(stm)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(furrr)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is a documentation of the code that was used to calculate the topic model. (Some of) the code will not be evaluated in this document but refer to a saved version of the topic model and the lemmatised tokens to save computing time and to ensure reproducibility.</p>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load Data</h2>
<p>Load the cleaned abstracts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># load data</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>clean_papers <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/clean_papers.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lemmatise" class="level2">
<h2 class="anchored" data-anchor-id="lemmatise">Lemmatise</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># load language model</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>ud_model_en <span class="ot">&lt;-</span> <span class="fu">udpipe_load_model</span>(<span class="st">"data/english-ewt-ud-2.5-191206.udpipe"</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># lemmatise</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>lemmas <span class="ot">&lt;-</span> <span class="fu">udpipe</span>(clean_papers<span class="sc">$</span>clean_abstract,</span>
<span id="cb3-6"><a href="#cb3-6"></a>                 <span class="at">object =</span> ud_model_en,</span>
<span id="cb3-7"><a href="#cb3-7"></a>                 <span class="at">parallel.cores =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="further-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="further-cleaning">Further Cleaning</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># combine lemmas with article information</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>lemmas <span class="ot">&lt;-</span> lemmas <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">doc_id =</span> <span class="fu">as.numeric</span>(doc_id))</span>
<span id="cb4-3"><a href="#cb4-3"></a>lemmas <span class="ot">&lt;-</span> <span class="fu">left_join</span>(<span class="at">x =</span> lemmas, <span class="at">y =</span> clean_papers)</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co"># keep only nouns</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>lemmas <span class="ot">&lt;-</span> lemmas <span class="sc">%&gt;%</span> <span class="fu">filter</span>(upos <span class="sc">==</span> <span class="st">"NOUN"</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co"># summarise on document level</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>docs <span class="ot">&lt;-</span> lemmas <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="fu">group_by</span>(doc_id) <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="fu">summarise</span>(<span class="at">lemmatised_abstract =</span> <span class="fu">paste</span>(lemma, <span class="at">collapse =</span> <span class="st">" "</span>),</span>
<span id="cb4-12"><a href="#cb4-12"></a>            <span class="fu">across</span>(<span class="fu">names</span>(clean_papers)[<span class="sc">-</span><span class="dv">1</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb4-13"><a href="#cb4-13"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-14"><a href="#cb4-14"></a>  <span class="fu">relocate</span>(lemmatised_abstract, <span class="at">.after =</span> abstract) <span class="sc">%&gt;%</span> </span>
<span id="cb4-15"><a href="#cb4-15"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># check again if abstract of covariates of interest have missing values</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>lemmatised_abstract))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE 
 1744 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE 
 1744 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>main_concept))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE 
 1744 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># clean again</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>docs <span class="ot">&lt;-</span> docs <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="co"># clean punctuation</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">mutate</span>(<span class="at">clean_abstract =</span> <span class="fu">str_replace_all</span>(lemmatised_abstract, <span class="st">"[:punct:]"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="co"># clean symbols</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">mutate</span>(<span class="at">clean_abstract =</span> <span class="fu">str_replace_all</span>(clean_abstract, <span class="st">"[:symbol:]"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="co"># clean numbers</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="fu">mutate</span>(<span class="at">clean_abstract =</span> <span class="fu">str_replace_all</span>(clean_abstract, <span class="st">"[:digit:]"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="co">#clean hashtags</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="fu">mutate</span>(<span class="at">clean_abstract =</span> <span class="fu">str_replace_all</span>(clean_abstract, <span class="st">"#</span><span class="sc">\\</span><span class="st">w+"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-11"><a href="#cb11-11"></a>  <span class="co"># clean unnecessary white spaces</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>  <span class="fu">mutate</span>(<span class="at">clean_abstract =</span> <span class="fu">str_squish</span>(clean_abstract)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-13"><a href="#cb11-13"></a>  <span class="co"># move clean abstract to front and remove lemmatised abstract variable</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>  <span class="fu">relocate</span>(clean_abstract, <span class="at">.after =</span> abstract) <span class="sc">%&gt;%</span> </span>
<span id="cb11-15"><a href="#cb11-15"></a>  <span class="fu">select</span>(<span class="sc">-</span>lemmatised_abstract)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># check again if abstract of covariates of interest have missing values</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>clean_abstract))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE 
 1744 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE 
 1744 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>main_concept))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE 
 1744 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># load words that are frequently used in abstracts of research articles</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>common_words <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/common_words.rds"</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>common_words</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "data"                      "condition"                
  [3] "survey"                    "factor"                   
  [5] "sample"                    "result"                   
  [7] "experiment"                "variable"                 
  [9] "questionnaire"             "regression"               
 [11] "respondent"                "scale"                    
 [13] "study"                     "paper"                    
 [15] "approach"                  "concept"                  
 [17] "framework"                 "analysis"                 
 [19] "theoretical"               "develop"                  
 [21] "discuss"                   "base"                     
 [23] "assessment"                "perspective"              
 [25] "question"                  "main"                     
 [27] "methodology"               "aim"                      
 [29] "theory"                    "apply"                    
 [31] "purpose"                   "reference"                
 [33] "context"                   "establish"                
 [35] "idea"                      "field"                    
 [37] "level"                     "understanding"            
 [39] "focus"                     "design"                   
 [41] "highlight"                 "potential"                
 [43] "basis"                     "evaluation"               
 [45] "methods"                   "identify"                 
 [47] "define"                    "follow"                   
 [49] "discussion"                "extensive"                
 [51] "practical"                 "aspect"                   
 [53] "propose"                   "conclusion"               
 [55] "classical"                 "article"                  
 [57] "facilitate"                "researchers"              
 [59] "possibility"               "literature"               
 [61] "content"                   "implication"              
 [63] "construction"              "emphasize"                
 [65] "empirical"                 "form"                     
 [67] "conceptual"                "paradigm"                 
 [69] "address"                   "key"                      
 [71] "interdisciplinary"         "review"                   
 [73] "adopt"                     "analyse"                  
 [75] "goal"                      "expect"                   
 [77] "implementation"            "change"                   
 [79] "description"               "alternative"              
 [81] "scope"                     "investigation"            
 [83] "step"                      "contemporary"             
 [85] "demonstrate"               "proposal"                 
 [87] "reflect"                   "characteristic"           
 [89] "draw"                      "sense"                    
 [91] "account"                   "introduce"                
 [93] "outline"                   "degree"                   
 [95] "definition"                "emphasis"                 
 [97] "start"                     "understand"               
 [99] "interpretation"            "list"                     
[101] "support"                   "attempt"                  
[103] "author"                    "investigate"              
[105] "center"                    "formal"                   
[107] "topic"                     "bring"                    
[109] "examine"                   "model"                    
[111] "enable"                    "view"                     
[113] "debate"                    "crucial"                  
[115] "reflection"                "involve"                  
[117] "overcome"                  "approaches"               
[119] "collaborative"             "conception"               
[121] "manage"                    "contribution"             
[123] "suitable"                  "stage"                    
[125] "abstract"                  "introduction"             
[127] "collaboration"             "refer"                    
[129] "object"                    "raise"                    
[131] "core"                      "incorporate"              
[133] "include"                   "organize"                 
[135] "map"                       "broad"                    
[137] "method"                    "exist"                    
[139] "critique"                  "seek"                     
[141] "logic"                     "sciences"                 
[143] "source"                    "evidence"                 
[145] "feedback"                  "notion"                   
[147] "produce"                   "component"                
[149] "relevant"                  "provide"                  
[151] "role"                      "external"                 
[153] "fit"                       "concern"                  
[155] "remain"                    "qualitative"              
[157] "objective"                 "foundation"               
[159] "designmethodologyapproach" "comparison"               
[161] "critically"                "explanation"              
[163] "scenario"                  "finding"                  
[165] "explain"                   "interaction"              
[167] "exploratory"               "experimental"             
[169] "construct"                 "theories"                 
[171] "exploration"               "measure"                  
[173] "findings"                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># unnest tokens and remove stopwords, typical words for research articles</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co"># and all words related to autonomy</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>tidy_docs <span class="ot">&lt;-</span> docs <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">unnest_tokens</span>(word, clean_abstract, <span class="at">token =</span> <span class="st">"words"</span>, <span class="at">to_lower =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="fu">anti_join</span>(<span class="fu">get_stopwords</span>(<span class="at">language =</span> <span class="st">"en"</span>, <span class="at">source=</span><span class="st">"stopwords-iso"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(word, <span class="st">"autonom"</span>)) <span class="sc">%&gt;%</span> <span class="co"># remove "autonomy" because this word should be in all topics</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>  <span class="fu">filter</span>(<span class="sc">!</span>word <span class="sc">%in%</span> common_words) <span class="sc">%&gt;%</span> <span class="co"># remove common research article words</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>  <span class="fu">add_count</span>(word) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> <span class="co"># remove very infrequent terms</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>  <span class="fu">select</span>(<span class="sc">-</span>n)</span>
<span id="cb20-11"><a href="#cb20-11"></a></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co"># sparse matrix</span></span>
<span id="cb20-13"><a href="#cb20-13"></a>sparse_docs <span class="ot">&lt;-</span> tidy_docs <span class="sc">%&gt;%</span></span>
<span id="cb20-14"><a href="#cb20-14"></a>  <span class="fu">count</span>(doc_id, word) <span class="sc">%&gt;%</span></span>
<span id="cb20-15"><a href="#cb20-15"></a>  <span class="fu">cast_sparse</span>(doc_id, word, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="topic-model" class="level2">
<h2 class="anchored" data-anchor-id="topic-model">Topic Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># define parameters</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>min <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>max <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>steps <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>k_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(min, max, steps)</span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co"># plan multiprocessing</span></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">8</span>)</span>
<span id="cb21-9"><a href="#cb21-9"></a></span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="co"># set seed</span></span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb21-12"><a href="#cb21-12"></a></span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="co"># calculate many models</span></span>
<span id="cb21-14"><a href="#cb21-14"></a>many_models <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">K =</span> k_range) <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15"></a>  <span class="fu">mutate</span>(<span class="at">topic_model =</span> <span class="fu">future_map</span>(K, </span>
<span id="cb21-16"><a href="#cb21-16"></a>                                  <span class="sc">~</span> <span class="fu">stm</span>(sparse_docs,</span>
<span id="cb21-17"><a href="#cb21-17"></a>                                        <span class="at">prevalence =</span><span class="sc">~</span> year <span class="sc">+</span> main_concept,</span>
<span id="cb21-18"><a href="#cb21-18"></a>                                        <span class="at">data =</span> docs,</span>
<span id="cb21-19"><a href="#cb21-19"></a>                                        <span class="at">gamma.prior =</span> <span class="st">"L1"</span>,</span>
<span id="cb21-20"><a href="#cb21-20"></a>                                        <span class="at">K =</span> .,</span>
<span id="cb21-21"><a href="#cb21-21"></a>                                        <span class="at">verbose =</span> <span class="cn">FALSE</span>),</span>
<span id="cb21-22"><a href="#cb21-22"></a>         <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="dv">42</span>),</span>
<span id="cb21-23"><a href="#cb21-23"></a>         <span class="at">.progress =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="model-diagnostics">Model Diagnostics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># make heldout</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>heldout <span class="ot">&lt;-</span> <span class="fu">make.heldout</span>(sparse_docs, <span class="at">seed =</span> <span class="dv">42</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co"># calculate diagnostics</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>k_result <span class="ot">&lt;-</span> many_models <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>  <span class="fu">mutate</span>(<span class="at">exclusivity =</span> <span class="fu">map</span>(topic_model, exclusivity),</span>
<span id="cb22-7"><a href="#cb22-7"></a>         <span class="at">semantic_coherence =</span> <span class="fu">map</span>(topic_model, semanticCoherence, sparse_docs),</span>
<span id="cb22-8"><a href="#cb22-8"></a>         <span class="at">eval_heldout =</span> <span class="fu">map</span>(topic_model, eval.heldout, heldout<span class="sc">$</span>missing),</span>
<span id="cb22-9"><a href="#cb22-9"></a>         <span class="at">residual =</span> <span class="fu">map</span>(topic_model, checkResiduals, sparse_docs),</span>
<span id="cb22-10"><a href="#cb22-10"></a>         <span class="at">bound =</span>  <span class="fu">map_dbl</span>(topic_model, <span class="cf">function</span>(x) <span class="fu">max</span>(x<span class="sc">$</span>convergence<span class="sc">$</span>bound)),</span>
<span id="cb22-11"><a href="#cb22-11"></a>         <span class="at">lfact =</span> <span class="fu">map_dbl</span>(topic_model, <span class="cf">function</span>(x) <span class="fu">lfactorial</span>(x<span class="sc">$</span>settings<span class="sc">$</span>dim<span class="sc">$</span>K)),</span>
<span id="cb22-12"><a href="#cb22-12"></a>         <span class="at">lbound =</span> bound <span class="sc">+</span> lfact,</span>
<span id="cb22-13"><a href="#cb22-13"></a>         <span class="at">iterations =</span> <span class="fu">map_dbl</span>(topic_model, <span class="cf">function</span>(x) <span class="fu">length</span>(x<span class="sc">$</span>convergence<span class="sc">$</span>bound)))</span>
<span id="cb22-14"><a href="#cb22-14"></a></span>
<span id="cb22-15"><a href="#cb22-15"></a><span class="co"># plot diagnostics</span></span>
<span id="cb22-16"><a href="#cb22-16"></a>k_result <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17"></a>  <span class="fu">transmute</span>(K,</span>
<span id="cb22-18"><a href="#cb22-18"></a>            <span class="st">`</span><span class="at">Lower bound</span><span class="st">`</span> <span class="ot">=</span> lbound,</span>
<span id="cb22-19"><a href="#cb22-19"></a>            <span class="at">Residuals =</span> <span class="fu">map_dbl</span>(residual, <span class="st">"dispersion"</span>),</span>
<span id="cb22-20"><a href="#cb22-20"></a>            <span class="st">`</span><span class="at">Semantic coherence</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">map_dbl</span>(semantic_coherence, mean),</span>
<span id="cb22-21"><a href="#cb22-21"></a>            <span class="st">`</span><span class="at">Held-out likelihood</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">map_dbl</span>(eval_heldout, <span class="st">"expected.heldout"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-22"><a href="#cb22-22"></a>  <span class="fu">gather</span>(Metric, Value, <span class="sc">-</span>K) <span class="sc">%&gt;%</span></span>
<span id="cb22-23"><a href="#cb22-23"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(K, Value)) <span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Metric, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb22-26"><a href="#cb22-26"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K (number of topics)"</span>,</span>
<span id="cb22-27"><a href="#cb22-27"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb22-28"><a href="#cb22-28"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tm_files/figure-html/model diagnostics-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># define range to check for exclusivity and semantic coherence</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co"># calculate exclusivity and semantic coherence</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>group_means <span class="ot">&lt;-</span> k_result <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="fu">select</span>(K, exclusivity, semantic_coherence) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="fu">filter</span>(K <span class="sc">%in%</span> range) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(exclusivity, semantic_coherence)) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="fu">mutate</span>(<span class="at">K =</span> <span class="fu">as.factor</span>(K)) <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>  <span class="fu">group_by</span>(K) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11"></a>  <span class="fu">summarise</span>(</span>
<span id="cb23-12"><a href="#cb23-12"></a>    <span class="at">exclusivity =</span> <span class="fu">mean</span>(exclusivity),</span>
<span id="cb23-13"><a href="#cb23-13"></a>    <span class="at">semantic_coherence =</span> <span class="fu">mean</span>(semantic_coherence)</span>
<span id="cb23-14"><a href="#cb23-14"></a>  )</span>
<span id="cb23-15"><a href="#cb23-15"></a></span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="co"># plot semantic coherence and exclusivity</span></span>
<span id="cb23-17"><a href="#cb23-17"></a>k_result <span class="sc">%&gt;%</span></span>
<span id="cb23-18"><a href="#cb23-18"></a>  <span class="fu">select</span>(K, exclusivity, semantic_coherence) <span class="sc">%&gt;%</span></span>
<span id="cb23-19"><a href="#cb23-19"></a>  <span class="fu">filter</span>(K <span class="sc">%in%</span> range) <span class="sc">%&gt;%</span></span>
<span id="cb23-20"><a href="#cb23-20"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(exclusivity, semantic_coherence)) <span class="sc">%&gt;%</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>  <span class="fu">mutate</span>(<span class="at">K =</span> <span class="fu">as.factor</span>(K)) <span class="sc">%&gt;%</span></span>
<span id="cb23-22"><a href="#cb23-22"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(semantic_coherence, exclusivity, <span class="at">z =</span> K, <span class="at">color =</span> K)) <span class="sc">+</span></span>
<span id="cb23-23"><a href="#cb23-23"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb23-24"><a href="#cb23-24"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> group_means, <span class="at">label =</span> group_means<span class="sc">$</span>K, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb23-25"><a href="#cb23-25"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Semantic coherence"</span>,</span>
<span id="cb23-26"><a href="#cb23-26"></a>       <span class="at">y =</span> <span class="st">"Exclusivity"</span>) <span class="sc">+</span></span>
<span id="cb23-27"><a href="#cb23-27"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb23-28"><a href="#cb23-28"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb23-29"><a href="#cb23-29"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> .<span class="dv">5</span>, <span class="at">end =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="tm_files/figure-html/model diagnostics-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># extract k = 14 model</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>topic_model <span class="ot">&lt;-</span> k_result <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">filter</span>(K <span class="sc">==</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">pull</span>(topic_model) <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="#cb24-5"></a>  .[[<span class="dv">1</span>]]</span>
<span id="cb24-6"><a href="#cb24-6"></a></span>
<span id="cb24-7"><a href="#cb24-7"></a>topic_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A topic model with 14 topics, 1744 documents and a 652 word dictionary.</code></pre>
</div>
</div>
</section>
<section id="inspect-model" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="inspect-model">Inspect Model</h2>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># beta (probabilities that each word is generated from each topic)</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>td_beta <span class="ot">&lt;-</span> <span class="fu">tidy</span>(topic_model)</span>
<span id="cb26-3"><a href="#cb26-3"></a>td_beta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,128  3
   topic term        beta
   &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;
 1     1 absence 5.38e- 4
 2     2 absence 1.76e- 3
 3     3 absence 7.69e-12
 4     4 absence 1.28e-13
 5     5 absence 5.54e- 9
 6     6 absence 1.08e- 4
 7     7 absence 4.17e-23
 8     8 absence 1.05e- 5
 9     9 absence 1.94e- 3
10    10 absence 5.66e- 7
#  with 9,118 more rows
#  Use `print(n = ...)` to see more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># gamma (probabilities that each document is generated from each topic)</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>td_gamma <span class="ot">&lt;-</span> <span class="fu">tidy</span>(topic_model, <span class="at">matrix =</span> <span class="st">"gamma"</span>,</span>
<span id="cb28-3"><a href="#cb28-3"></a>                 <span class="at">document_names =</span> <span class="fu">rownames</span>(sparse_docs))</span>
<span id="cb28-4"><a href="#cb28-4"></a>td_gamma</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24,416  3
   document topic   gamma
   &lt;chr&gt;    &lt;int&gt;   &lt;dbl&gt;
 1 1            1 0.00925
 2 2            1 0.00573
 3 3            1 0.0268 
 4 4            1 0.00456
 5 5            1 0.0174 
 6 6            1 0.0332 
 7 7            1 0.0235 
 8 8            1 0.0212 
 9 9            1 0.00209
10 10           1 0.00303
#  with 24,406 more rows
#  Use `print(n = ...)` to see more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># top terms</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>top_terms <span class="ot">&lt;-</span> td_beta <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">arrange</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="fu">top_n</span>(<span class="dv">20</span>, beta) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>beta) <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7"></a>  <span class="fu">select</span>(topic, term) <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>  <span class="fu">summarise</span>(<span class="at">terms =</span> <span class="fu">list</span>(term)) <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>  <span class="fu">mutate</span>(<span class="at">terms =</span> <span class="fu">map</span>(terms, paste, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-10"><a href="#cb30-10"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(terms))</span>
<span id="cb30-11"><a href="#cb30-11"></a></span>
<span id="cb30-12"><a href="#cb30-12"></a>top_terms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14  2
   topic terms                                                                  
   &lt;int&gt; &lt;chr&gt;                                                                  
 1     1 life, woman, child, family, parent, time, sex, phone, image, gender, a
 2     2 internet, law, freedom, privacy, principle, rights, issue, protection,
 3     3 government, management, policy, governance, development, service, busi
 4     4 student, school, teacher, college, class, classroom, perception, scien
 5     5 employee, job, worker, innovation, relationship, performance, organiza
 6     6 learner, language, teaching, teacher, technology, internet, learning, 
 7     7 internet, relationship, adolescent, behavior, consumer, dimension, add
 8     8 participant, motivation, competence, satisfaction, relatedness, activi
 9     9 health, care, patient, people, nurse, healthcare, professional, decisi
10    10 media, network, community, space, identity, culture, platform, practic
11    11 team, agent, time, task, target, communication, failure, situation, pr
12    12 technology, user, communication, people, device, service, tool, applic
13    13 education, process, institution, skill, development, university, train
14    14 control, intelligence, knowledge, solution, environment, issue, trust,</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># top gamma terms</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>gamma_terms <span class="ot">&lt;-</span> td_gamma <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="fu">summarise</span>(<span class="at">gamma =</span> <span class="fu">mean</span>(gamma)) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(gamma)) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="fu">left_join</span>(top_terms, <span class="at">by =</span> <span class="st">"topic"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>  <span class="fu">mutate</span>(<span class="at">topic =</span> <span class="fu">paste0</span>(<span class="st">"Topic "</span>, topic),</span>
<span id="cb32-8"><a href="#cb32-8"></a>         <span class="at">topic =</span> <span class="fu">reorder</span>(topic, gamma))</span>
<span id="cb32-9"><a href="#cb32-9"></a></span>
<span id="cb32-10"><a href="#cb32-10"></a>gamma_terms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14  3
   topic     gamma terms                                                        
   &lt;fct&gt;     &lt;dbl&gt; &lt;chr&gt;                                                        
 1 Topic 6  0.111  learner, language, teaching, teacher, technology, internet, 
 2 Topic 2  0.102  internet, law, freedom, privacy, principle, rights, issue, p
 3 Topic 10 0.0996 media, network, community, space, identity, culture, platfor
 4 Topic 12 0.0864 technology, user, communication, people, device, service, to
 5 Topic 4  0.0706 student, school, teacher, college, class, classroom, percept
 6 Topic 14 0.0701 control, intelligence, knowledge, solution, environment, iss
 7 Topic 3  0.0677 government, management, policy, governance, development, ser
 8 Topic 13 0.0669 education, process, institution, skill, development, univers
 9 Topic 7  0.0632 internet, relationship, adolescent, behavior, consumer, dime
10 Topic 5  0.0607 employee, job, worker, innovation, relationship, performance
11 Topic 8  0.0598 participant, motivation, competence, satisfaction, relatedne
12 Topic 1  0.0542 life, woman, child, family, parent, time, sex, phone, image,
13 Topic 9  0.0539 health, care, patient, people, nurse, healthcare, profession
14 Topic 11 0.0334 team, agent, time, task, target, communication, failure, sit</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># plot top gamma terms</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>gamma_terms <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(topic, gamma, <span class="at">label =</span> <span class="fu">str_wrap</span>(terms, <span class="at">width =</span> <span class="dv">170</span>))) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">nudge_y =</span> <span class="fl">0.005</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="fu">expression</span>(gamma)) <span class="sc">+</span> </span>
<span id="cb34-9"><a href="#cb34-9"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<p><img src="tm_files/figure-html/inspect model-1.png" class="img-fluid" width="1440"></p>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># get top topic (highest probability) per doc</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>top_classification <span class="ot">&lt;-</span> td_gamma <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="fu">group_by</span>(document) <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="fu">top_n</span>(<span class="dv">1</span>, gamma) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="fu">mutate</span>(<span class="at">doc_id =</span> <span class="fu">as.numeric</span>(document))</span>
<span id="cb35-7"><a href="#cb35-7"></a></span>
<span id="cb35-8"><a href="#cb35-8"></a>top_classification</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,744  4
   document topic gamma doc_id
   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 13           1 0.401     13
 2 16           1 0.429     16
 3 37           1 0.675     37
 4 38           1 0.604     38
 5 42           1 0.358     42
 6 51           1 0.531     51
 7 98           1 0.608     98
 8 120          1 0.366    120
 9 150          1 0.682    150
10 156          1 0.270    156
#  with 1,734 more rows
#  Use `print(n = ...)` to see more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># add top topic (highest probability) to docs</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>topic_docs <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(docs, top_classification) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="fu">relocate</span>(topic, gamma, <span class="at">.after =</span> doc_id)</span>
<span id="cb37-4"><a href="#cb37-4"></a></span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="co"># get top concepts by topic</span></span>
<span id="cb37-6"><a href="#cb37-6"></a>top_topic_concepts <span class="ot">&lt;-</span> topic_docs <span class="sc">%&gt;%</span> </span>
<span id="cb37-7"><a href="#cb37-7"></a>  <span class="fu">select</span>(<span class="sc">-</span>concept_id, <span class="sc">-</span>concept_score, <span class="sc">-</span>concept_lecel, <span class="sc">-</span>concept_url) <span class="sc">%&gt;%</span> </span>
<span id="cb37-8"><a href="#cb37-8"></a>  <span class="fu">unnest</span>(all_concepts) <span class="sc">%&gt;%</span> </span>
<span id="cb37-9"><a href="#cb37-9"></a>  <span class="fu">filter</span>(concept_name <span class="sc">!=</span> <span class="st">"Autonomy"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-10"><a href="#cb37-10"></a>  <span class="fu">group_by</span>(doc_id, topic) <span class="sc">%&gt;%</span> </span>
<span id="cb37-11"><a href="#cb37-11"></a>  <span class="fu">arrange</span>(concept_lecel, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>  <span class="fu">group_by</span>(topic, concept_name) <span class="sc">%&gt;%</span> </span>
<span id="cb37-13"><a href="#cb37-13"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb37-14"><a href="#cb37-14"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n), <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-15"><a href="#cb37-15"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-16"><a href="#cb37-16"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-17"><a href="#cb37-17"></a>    <span class="at">top_topic_concepts =</span> <span class="fu">str_flatten</span>(concept_name, <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb37-18"><a href="#cb37-18"></a>    <span class="at">topic =</span> <span class="fu">str_c</span>(<span class="st">"Topic "</span>, topic) <span class="sc">%&gt;%</span> <span class="fu">as_factor</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb37-19"><a href="#cb37-19"></a>  <span class="fu">nest</span>(<span class="at">all_concepts =</span> <span class="fu">c</span>(concept_name, n))</span>
<span id="cb37-20"><a href="#cb37-20"></a></span>
<span id="cb37-21"><a href="#cb37-21"></a>top_topic_concepts <span class="ot">&lt;-</span> <span class="fu">left_join</span>(gamma_terms, top_topic_concepts)</span>
<span id="cb37-22"><a href="#cb37-22"></a></span>
<span id="cb37-23"><a href="#cb37-23"></a><span class="co"># add manual topic labels after inspecting concepts and top words</span></span>
<span id="cb37-24"><a href="#cb37-24"></a>topic_labels <span class="ot">&lt;-</span> </span>
<span id="cb37-25"><a href="#cb37-25"></a>  <span class="fu">tribble</span>(</span>
<span id="cb37-26"><a href="#cb37-26"></a>    <span class="sc">~</span> topic, <span class="sc">~</span> label,</span>
<span id="cb37-27"><a href="#cb37-27"></a>    <span class="st">"Topic 1"</span>, <span class="st">"Adolescence"</span>,</span>
<span id="cb37-28"><a href="#cb37-28"></a>    <span class="st">"Topic 2"</span>, <span class="st">"Digital Policy"</span>,</span>
<span id="cb37-29"><a href="#cb37-29"></a>    <span class="st">"Topic 3"</span>, <span class="st">"Digital Policy"</span>,</span>
<span id="cb37-30"><a href="#cb37-30"></a>    <span class="st">"Topic 4"</span>, <span class="st">"Digital Pedagogy"</span>,</span>
<span id="cb37-31"><a href="#cb37-31"></a>    <span class="st">"Topic 5"</span>, <span class="st">"Digital Workplace"</span>,</span>
<span id="cb37-32"><a href="#cb37-32"></a>    <span class="st">"Topic 6"</span>, <span class="st">"Digital Pedagogy"</span>,</span>
<span id="cb37-33"><a href="#cb37-33"></a>    <span class="st">"Topic 7"</span>, <span class="st">"Digital Media Use"</span>,</span>
<span id="cb37-34"><a href="#cb37-34"></a>    <span class="st">"Topic 8"</span>, <span class="st">"Digital Media Use"</span>,</span>
<span id="cb37-35"><a href="#cb37-35"></a>    <span class="st">"Topic 9"</span>, <span class="st">"Digital Healthcare"</span>,</span>
<span id="cb37-36"><a href="#cb37-36"></a>    <span class="st">"Topic 10"</span>, <span class="st">"Digital Power Structures"</span>,</span>
<span id="cb37-37"><a href="#cb37-37"></a>    <span class="st">"Topic 11"</span>, <span class="st">"Machine Autonomy"</span>,</span>
<span id="cb37-38"><a href="#cb37-38"></a>    <span class="st">"Topic 12"</span>, <span class="st">"Digital Policy"</span>,</span>
<span id="cb37-39"><a href="#cb37-39"></a>    <span class="st">"Topic 13"</span>, <span class="st">"Digital Pedagogy"</span>,</span>
<span id="cb37-40"><a href="#cb37-40"></a>    <span class="st">"Topic 14"</span>, <span class="st">"Machine Autonomy"</span>,</span>
<span id="cb37-41"><a href="#cb37-41"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-42"><a href="#cb37-42"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-43"><a href="#cb37-43"></a>    <span class="at">topic =</span> <span class="fu">as.factor</span>(topic),</span>
<span id="cb37-44"><a href="#cb37-44"></a>    <span class="at">label =</span> <span class="fu">as.factor</span>(label)</span>
<span id="cb37-45"><a href="#cb37-45"></a>  )</span>
<span id="cb37-46"><a href="#cb37-46"></a></span>
<span id="cb37-47"><a href="#cb37-47"></a><span class="co"># order by sum of gamma by manual topic</span></span>
<span id="cb37-48"><a href="#cb37-48"></a>top_topic_concepts_plot <span class="ot">&lt;-</span> <span class="fu">left_join</span>(top_topic_concepts, topic_labels) <span class="sc">%&gt;%</span> </span>
<span id="cb37-49"><a href="#cb37-49"></a>  <span class="fu">group_by</span>(label) <span class="sc">%&gt;%</span> </span>
<span id="cb37-50"><a href="#cb37-50"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-51"><a href="#cb37-51"></a>    <span class="at">order =</span> <span class="fu">sum</span>(gamma)</span>
<span id="cb37-52"><a href="#cb37-52"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb37-53"><a href="#cb37-53"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-54"><a href="#cb37-54"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">fct_reorder</span>(label, order, <span class="at">.desc =</span> <span class="cn">TRUE</span>))</span>
<span id="cb37-55"><a href="#cb37-55"></a></span>
<span id="cb37-56"><a href="#cb37-56"></a><span class="co"># plot  </span></span>
<span id="cb37-57"><a href="#cb37-57"></a>p1 <span class="ot">&lt;-</span> top_topic_concepts_plot <span class="sc">%&gt;%</span> </span>
<span id="cb37-58"><a href="#cb37-58"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(topic, gamma)) <span class="sc">+</span></span>
<span id="cb37-59"><a href="#cb37-59"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb37-60"><a href="#cb37-60"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb37-61"><a href="#cb37-61"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(),</span>
<span id="cb37-62"><a href="#cb37-62"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">15</span>), <span class="at">position =</span> <span class="st">"right"</span>,</span>
<span id="cb37-63"><a href="#cb37-63"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">05</span>, .<span class="dv">1</span>, .<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb37-64"><a href="#cb37-64"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="fu">expression</span>(gamma <span class="sc">~</span> <span class="st">" (Topic Prevalence)"</span>)) <span class="sc">+</span> </span>
<span id="cb37-65"><a href="#cb37-65"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(label), <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">space =</span> <span class="st">"free_y"</span>,</span>
<span id="cb37-66"><a href="#cb37-66"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">label =</span> <span class="fu">label_wrap_gen</span>(<span class="dv">10</span>)),</span>
<span id="cb37-67"><a href="#cb37-67"></a>             <span class="at">switch =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb37-68"><a href="#cb37-68"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb37-69"><a href="#cb37-69"></a>  <span class="fu">theme</span>(<span class="at">strip.text.y.left =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb37-70"><a href="#cb37-70"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-71"><a href="#cb37-71"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>())</span>
<span id="cb37-72"><a href="#cb37-72"></a></span>
<span id="cb37-73"><a href="#cb37-73"></a>p2 <span class="ot">&lt;-</span> top_topic_concepts_plot <span class="sc">%&gt;%</span> </span>
<span id="cb37-74"><a href="#cb37-74"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(topic, gamma)) <span class="sc">+</span></span>
<span id="cb37-75"><a href="#cb37-75"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_wrap</span>(terms, <span class="at">width =</span> <span class="dv">120</span>), <span class="at">y =</span> <span class="dv">0</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb37-76"><a href="#cb37-76"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb37-77"><a href="#cb37-77"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb37-78"><a href="#cb37-78"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(label), <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">space =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb37-79"><a href="#cb37-79"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb37-80"><a href="#cb37-80"></a>  <span class="fu">ylab</span>(<span class="st">"Top Words"</span>) <span class="sc">+</span></span>
<span id="cb37-81"><a href="#cb37-81"></a>  <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-82"><a href="#cb37-82"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"#ffffff"</span>),</span>
<span id="cb37-83"><a href="#cb37-83"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"#ffffff"</span>),</span>
<span id="cb37-84"><a href="#cb37-84"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-85"><a href="#cb37-85"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-86"><a href="#cb37-86"></a>        <span class="at">strip.background.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-87"><a href="#cb37-87"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-88"><a href="#cb37-88"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-89"><a href="#cb37-89"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>())</span>
<span id="cb37-90"><a href="#cb37-90"></a></span>
<span id="cb37-91"><a href="#cb37-91"></a>p3 <span class="ot">&lt;-</span> top_topic_concepts_plot <span class="sc">%&gt;%</span> </span>
<span id="cb37-92"><a href="#cb37-92"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(topic, gamma)) <span class="sc">+</span></span>
<span id="cb37-93"><a href="#cb37-93"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_wrap</span>(<span class="fu">str_to_lower</span>(top_topic_concepts), <span class="at">width =</span> <span class="dv">45</span>), <span class="at">y =</span> <span class="dv">0</span>),</span>
<span id="cb37-94"><a href="#cb37-94"></a>            <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb37-95"><a href="#cb37-95"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb37-96"><a href="#cb37-96"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb37-97"><a href="#cb37-97"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(label), <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">space =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb37-98"><a href="#cb37-98"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb37-99"><a href="#cb37-99"></a>  <span class="fu">ylab</span>(<span class="st">"Top Concepts"</span>) <span class="sc">+</span></span>
<span id="cb37-100"><a href="#cb37-100"></a>  <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-101"><a href="#cb37-101"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"#ffffff"</span>),</span>
<span id="cb37-102"><a href="#cb37-102"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-103"><a href="#cb37-103"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-104"><a href="#cb37-104"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-105"><a href="#cb37-105"></a>        <span class="at">strip.background.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-106"><a href="#cb37-106"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-107"><a href="#cb37-107"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-108"><a href="#cb37-108"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>())</span>
<span id="cb37-109"><a href="#cb37-109"></a></span>
<span id="cb37-110"><a href="#cb37-110"></a><span class="fu">ggarrange</span>(p1, p2, p3,</span>
<span id="cb37-111"><a href="#cb37-111"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb37-112"><a href="#cb37-112"></a>          <span class="at">widths =</span> <span class="fu">c</span>(.<span class="dv">6</span> , <span class="fl">1.7</span>, .<span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<p><img src="tm_files/figure-html/inspect model-2.png" class="img-fluid" width="1440"></p>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb38" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1"></a><span class="co">---</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="an">title:</span><span class="co"> "Topic Modeling"</span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="an">author:</span><span class="co"> "Felix Dietrich &amp; Leonard Reinecke"</span></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="an">date:</span><span class="co"> "last-modified"</span></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="an">categories:</span></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="co">  - "Autonomy"</span></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="co">  - "Digital Media"</span></span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="co">  - "Self-Determination"</span></span>
<span id="cb38-9"><a href="#cb38-9"></a><span class="co">---</span></span>
<span id="cb38-10"><a href="#cb38-10"></a></span>
<span id="cb38-13"><a href="#cb38-13"></a><span class="in">```{r}</span></span>
<span id="cb38-14"><a href="#cb38-14"></a><span class="co">#| label: libs</span></span>
<span id="cb38-15"><a href="#cb38-15"></a><span class="co">#| eval: false</span></span>
<span id="cb38-16"><a href="#cb38-16"></a></span>
<span id="cb38-17"><a href="#cb38-17"></a><span class="co"># libs</span></span>
<span id="cb38-18"><a href="#cb38-18"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb38-19"><a href="#cb38-19"></a><span class="fu">library</span>(udpipe)</span>
<span id="cb38-20"><a href="#cb38-20"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb38-21"><a href="#cb38-21"></a><span class="fu">library</span>(stm)</span>
<span id="cb38-22"><a href="#cb38-22"></a><span class="fu">library</span>(furrr)</span>
<span id="cb38-23"><a href="#cb38-23"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb38-24"><a href="#cb38-24"></a><span class="in">```</span></span>
<span id="cb38-25"><a href="#cb38-25"></a></span>
<span id="cb38-28"><a href="#cb38-28"></a><span class="in">```{r}</span></span>
<span id="cb38-29"><a href="#cb38-29"></a><span class="co">#| label: load needed objects</span></span>
<span id="cb38-30"><a href="#cb38-30"></a><span class="co">#| include: false</span></span>
<span id="cb38-31"><a href="#cb38-31"></a></span>
<span id="cb38-32"><a href="#cb38-32"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb38-33"><a href="#cb38-33"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb38-34"><a href="#cb38-34"></a><span class="fu">library</span>(stm)</span>
<span id="cb38-35"><a href="#cb38-35"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb38-36"><a href="#cb38-36"></a>many_models <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/many_models.rds"</span>)</span>
<span id="cb38-37"><a href="#cb38-37"></a>lemmas <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/lemmas.rds"</span>)</span>
<span id="cb38-38"><a href="#cb38-38"></a><span class="in">```</span></span>
<span id="cb38-39"><a href="#cb38-39"></a></span>
<span id="cb38-40"><a href="#cb38-40"></a></span>
<span id="cb38-41"><a href="#cb38-41"></a>This is a documentation of the code that was used to calculate the topic model.</span>
<span id="cb38-42"><a href="#cb38-42"></a>(Some of) the code will not be evaluated in this document but refer to a saved</span>
<span id="cb38-43"><a href="#cb38-43"></a>version of the topic model and the lemmatised tokens to save computing time</span>
<span id="cb38-44"><a href="#cb38-44"></a>and to ensure reproducibility.</span>
<span id="cb38-45"><a href="#cb38-45"></a></span>
<span id="cb38-46"><a href="#cb38-46"></a><span class="fu">## Load Data</span></span>
<span id="cb38-47"><a href="#cb38-47"></a></span>
<span id="cb38-48"><a href="#cb38-48"></a>Load the cleaned abstracts.</span>
<span id="cb38-49"><a href="#cb38-49"></a></span>
<span id="cb38-52"><a href="#cb38-52"></a><span class="in">```{r}</span></span>
<span id="cb38-53"><a href="#cb38-53"></a><span class="co">#| label: load data</span></span>
<span id="cb38-54"><a href="#cb38-54"></a></span>
<span id="cb38-55"><a href="#cb38-55"></a><span class="co"># load data</span></span>
<span id="cb38-56"><a href="#cb38-56"></a>clean_papers <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/clean_papers.rds"</span>)</span>
<span id="cb38-57"><a href="#cb38-57"></a><span class="in">```</span></span>
<span id="cb38-58"><a href="#cb38-58"></a></span>
<span id="cb38-59"><a href="#cb38-59"></a><span class="fu">## Lemmatise</span></span>
<span id="cb38-60"><a href="#cb38-60"></a></span>
<span id="cb38-63"><a href="#cb38-63"></a><span class="in">```{r}</span></span>
<span id="cb38-64"><a href="#cb38-64"></a><span class="co">#| label: lemmatise</span></span>
<span id="cb38-65"><a href="#cb38-65"></a><span class="co">#| eval: false</span></span>
<span id="cb38-66"><a href="#cb38-66"></a></span>
<span id="cb38-67"><a href="#cb38-67"></a><span class="co"># load language model</span></span>
<span id="cb38-68"><a href="#cb38-68"></a>ud_model_en <span class="ot">&lt;-</span> <span class="fu">udpipe_load_model</span>(<span class="st">"data/english-ewt-ud-2.5-191206.udpipe"</span>)</span>
<span id="cb38-69"><a href="#cb38-69"></a></span>
<span id="cb38-70"><a href="#cb38-70"></a><span class="co"># lemmatise</span></span>
<span id="cb38-71"><a href="#cb38-71"></a>lemmas <span class="ot">&lt;-</span> <span class="fu">udpipe</span>(clean_papers<span class="sc">$</span>clean_abstract,</span>
<span id="cb38-72"><a href="#cb38-72"></a>                 <span class="at">object =</span> ud_model_en,</span>
<span id="cb38-73"><a href="#cb38-73"></a>                 <span class="at">parallel.cores =</span> <span class="dv">8</span>)</span>
<span id="cb38-74"><a href="#cb38-74"></a><span class="in">```</span></span>
<span id="cb38-75"><a href="#cb38-75"></a></span>
<span id="cb38-76"><a href="#cb38-76"></a><span class="fu">## Further Cleaning</span></span>
<span id="cb38-77"><a href="#cb38-77"></a></span>
<span id="cb38-80"><a href="#cb38-80"></a><span class="in">```{r}</span></span>
<span id="cb38-81"><a href="#cb38-81"></a><span class="co">#| label: further cleaning</span></span>
<span id="cb38-82"><a href="#cb38-82"></a><span class="co">#| message: false</span></span>
<span id="cb38-83"><a href="#cb38-83"></a></span>
<span id="cb38-84"><a href="#cb38-84"></a><span class="co"># combine lemmas with article information</span></span>
<span id="cb38-85"><a href="#cb38-85"></a>lemmas <span class="ot">&lt;-</span> lemmas <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">doc_id =</span> <span class="fu">as.numeric</span>(doc_id))</span>
<span id="cb38-86"><a href="#cb38-86"></a>lemmas <span class="ot">&lt;-</span> <span class="fu">left_join</span>(<span class="at">x =</span> lemmas, <span class="at">y =</span> clean_papers)</span>
<span id="cb38-87"><a href="#cb38-87"></a></span>
<span id="cb38-88"><a href="#cb38-88"></a><span class="co"># keep only nouns</span></span>
<span id="cb38-89"><a href="#cb38-89"></a>lemmas <span class="ot">&lt;-</span> lemmas <span class="sc">%&gt;%</span> <span class="fu">filter</span>(upos <span class="sc">==</span> <span class="st">"NOUN"</span>)</span>
<span id="cb38-90"><a href="#cb38-90"></a></span>
<span id="cb38-91"><a href="#cb38-91"></a><span class="co"># summarise on document level</span></span>
<span id="cb38-92"><a href="#cb38-92"></a>docs <span class="ot">&lt;-</span> lemmas <span class="sc">%&gt;%</span></span>
<span id="cb38-93"><a href="#cb38-93"></a>  <span class="fu">group_by</span>(doc_id) <span class="sc">%&gt;%</span></span>
<span id="cb38-94"><a href="#cb38-94"></a>  <span class="fu">summarise</span>(<span class="at">lemmatised_abstract =</span> <span class="fu">paste</span>(lemma, <span class="at">collapse =</span> <span class="st">" "</span>),</span>
<span id="cb38-95"><a href="#cb38-95"></a>            <span class="fu">across</span>(<span class="fu">names</span>(clean_papers)[<span class="sc">-</span><span class="dv">1</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb38-96"><a href="#cb38-96"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-97"><a href="#cb38-97"></a>  <span class="fu">relocate</span>(lemmatised_abstract, <span class="at">.after =</span> abstract) <span class="sc">%&gt;%</span> </span>
<span id="cb38-98"><a href="#cb38-98"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb38-99"><a href="#cb38-99"></a><span class="in">```</span></span>
<span id="cb38-100"><a href="#cb38-100"></a></span>
<span id="cb38-103"><a href="#cb38-103"></a><span class="in">```{r}</span></span>
<span id="cb38-104"><a href="#cb38-104"></a><span class="co">#| label: further cleaning 2</span></span>
<span id="cb38-105"><a href="#cb38-105"></a><span class="co">#| message: false</span></span>
<span id="cb38-106"><a href="#cb38-106"></a></span>
<span id="cb38-107"><a href="#cb38-107"></a><span class="co"># check again if abstract of covariates of interest have missing values</span></span>
<span id="cb38-108"><a href="#cb38-108"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>lemmatised_abstract))</span>
<span id="cb38-109"><a href="#cb38-109"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>year))</span>
<span id="cb38-110"><a href="#cb38-110"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>main_concept))</span>
<span id="cb38-111"><a href="#cb38-111"></a></span>
<span id="cb38-112"><a href="#cb38-112"></a><span class="co"># clean again</span></span>
<span id="cb38-113"><a href="#cb38-113"></a>docs <span class="ot">&lt;-</span> docs <span class="sc">%&gt;%</span> </span>
<span id="cb38-114"><a href="#cb38-114"></a>  <span class="co"># clean punctuation</span></span>
<span id="cb38-115"><a href="#cb38-115"></a>  <span class="fu">mutate</span>(<span class="at">clean_abstract =</span> <span class="fu">str_replace_all</span>(lemmatised_abstract, <span class="st">"[:punct:]"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-116"><a href="#cb38-116"></a>  <span class="co"># clean symbols</span></span>
<span id="cb38-117"><a href="#cb38-117"></a>  <span class="fu">mutate</span>(<span class="at">clean_abstract =</span> <span class="fu">str_replace_all</span>(clean_abstract, <span class="st">"[:symbol:]"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-118"><a href="#cb38-118"></a>  <span class="co"># clean numbers</span></span>
<span id="cb38-119"><a href="#cb38-119"></a>  <span class="fu">mutate</span>(<span class="at">clean_abstract =</span> <span class="fu">str_replace_all</span>(clean_abstract, <span class="st">"[:digit:]"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-120"><a href="#cb38-120"></a>  <span class="co">#clean hashtags</span></span>
<span id="cb38-121"><a href="#cb38-121"></a>  <span class="fu">mutate</span>(<span class="at">clean_abstract =</span> <span class="fu">str_replace_all</span>(clean_abstract, <span class="st">"#</span><span class="sc">\\</span><span class="st">w+"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-122"><a href="#cb38-122"></a>  <span class="co"># clean unnecessary white spaces</span></span>
<span id="cb38-123"><a href="#cb38-123"></a>  <span class="fu">mutate</span>(<span class="at">clean_abstract =</span> <span class="fu">str_squish</span>(clean_abstract)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-124"><a href="#cb38-124"></a>  <span class="co"># move clean abstract to front and remove lemmatised abstract variable</span></span>
<span id="cb38-125"><a href="#cb38-125"></a>  <span class="fu">relocate</span>(clean_abstract, <span class="at">.after =</span> abstract) <span class="sc">%&gt;%</span> </span>
<span id="cb38-126"><a href="#cb38-126"></a>  <span class="fu">select</span>(<span class="sc">-</span>lemmatised_abstract)</span>
<span id="cb38-127"><a href="#cb38-127"></a></span>
<span id="cb38-128"><a href="#cb38-128"></a><span class="in">```</span></span>
<span id="cb38-129"><a href="#cb38-129"></a></span>
<span id="cb38-132"><a href="#cb38-132"></a><span class="in">```{r}</span></span>
<span id="cb38-133"><a href="#cb38-133"></a><span class="co">#| label: further cleaning 3</span></span>
<span id="cb38-134"><a href="#cb38-134"></a><span class="co">#| message: false</span></span>
<span id="cb38-135"><a href="#cb38-135"></a></span>
<span id="cb38-136"><a href="#cb38-136"></a><span class="co"># check again if abstract of covariates of interest have missing values</span></span>
<span id="cb38-137"><a href="#cb38-137"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>clean_abstract))</span>
<span id="cb38-138"><a href="#cb38-138"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>year))</span>
<span id="cb38-139"><a href="#cb38-139"></a><span class="fu">table</span>(<span class="fu">is.na</span>(docs<span class="sc">$</span>main_concept))</span>
<span id="cb38-140"><a href="#cb38-140"></a></span>
<span id="cb38-141"><a href="#cb38-141"></a><span class="co"># load words that are frequently used in abstracts of research articles</span></span>
<span id="cb38-142"><a href="#cb38-142"></a>common_words <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/common_words.rds"</span>)</span>
<span id="cb38-143"><a href="#cb38-143"></a>common_words</span>
<span id="cb38-144"><a href="#cb38-144"></a></span>
<span id="cb38-145"><a href="#cb38-145"></a><span class="co"># unnest tokens and remove stopwords, typical words for research articles</span></span>
<span id="cb38-146"><a href="#cb38-146"></a><span class="co"># and all words related to autonomy</span></span>
<span id="cb38-147"><a href="#cb38-147"></a>tidy_docs <span class="ot">&lt;-</span> docs <span class="sc">%&gt;%</span></span>
<span id="cb38-148"><a href="#cb38-148"></a>  <span class="fu">unnest_tokens</span>(word, clean_abstract, <span class="at">token =</span> <span class="st">"words"</span>, <span class="at">to_lower =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-149"><a href="#cb38-149"></a>  <span class="fu">anti_join</span>(<span class="fu">get_stopwords</span>(<span class="at">language =</span> <span class="st">"en"</span>, <span class="at">source=</span><span class="st">"stopwords-iso"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-150"><a href="#cb38-150"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(word, <span class="st">"autonom"</span>)) <span class="sc">%&gt;%</span> <span class="co"># remove "autonomy" because this word should be in all topics</span></span>
<span id="cb38-151"><a href="#cb38-151"></a>  <span class="fu">filter</span>(<span class="sc">!</span>word <span class="sc">%in%</span> common_words) <span class="sc">%&gt;%</span> <span class="co"># remove common research article words</span></span>
<span id="cb38-152"><a href="#cb38-152"></a>  <span class="fu">add_count</span>(word) <span class="sc">%&gt;%</span></span>
<span id="cb38-153"><a href="#cb38-153"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span> <span class="co"># remove very infrequent terms</span></span>
<span id="cb38-154"><a href="#cb38-154"></a>  <span class="fu">select</span>(<span class="sc">-</span>n)</span>
<span id="cb38-155"><a href="#cb38-155"></a></span>
<span id="cb38-156"><a href="#cb38-156"></a><span class="co"># sparse matrix</span></span>
<span id="cb38-157"><a href="#cb38-157"></a>sparse_docs <span class="ot">&lt;-</span> tidy_docs <span class="sc">%&gt;%</span></span>
<span id="cb38-158"><a href="#cb38-158"></a>  <span class="fu">count</span>(doc_id, word) <span class="sc">%&gt;%</span></span>
<span id="cb38-159"><a href="#cb38-159"></a>  <span class="fu">cast_sparse</span>(doc_id, word, n)</span>
<span id="cb38-160"><a href="#cb38-160"></a><span class="in">```</span></span>
<span id="cb38-161"><a href="#cb38-161"></a></span>
<span id="cb38-162"><a href="#cb38-162"></a><span class="fu">## Topic Model</span></span>
<span id="cb38-163"><a href="#cb38-163"></a></span>
<span id="cb38-166"><a href="#cb38-166"></a><span class="in">```{r}</span></span>
<span id="cb38-167"><a href="#cb38-167"></a><span class="co">#| label: topic model</span></span>
<span id="cb38-168"><a href="#cb38-168"></a><span class="co">#| eval: false</span></span>
<span id="cb38-169"><a href="#cb38-169"></a></span>
<span id="cb38-170"><a href="#cb38-170"></a><span class="co"># define parameters</span></span>
<span id="cb38-171"><a href="#cb38-171"></a>min <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb38-172"><a href="#cb38-172"></a>max <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb38-173"><a href="#cb38-173"></a>steps <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb38-174"><a href="#cb38-174"></a>k_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(min, max, steps)</span>
<span id="cb38-175"><a href="#cb38-175"></a></span>
<span id="cb38-176"><a href="#cb38-176"></a><span class="co"># plan multiprocessing</span></span>
<span id="cb38-177"><a href="#cb38-177"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">8</span>)</span>
<span id="cb38-178"><a href="#cb38-178"></a></span>
<span id="cb38-179"><a href="#cb38-179"></a><span class="co"># set seed</span></span>
<span id="cb38-180"><a href="#cb38-180"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb38-181"><a href="#cb38-181"></a></span>
<span id="cb38-182"><a href="#cb38-182"></a><span class="co"># calculate many models</span></span>
<span id="cb38-183"><a href="#cb38-183"></a>many_models <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">K =</span> k_range) <span class="sc">%&gt;%</span></span>
<span id="cb38-184"><a href="#cb38-184"></a>  <span class="fu">mutate</span>(<span class="at">topic_model =</span> <span class="fu">future_map</span>(K, </span>
<span id="cb38-185"><a href="#cb38-185"></a>                                  <span class="sc">~</span> <span class="fu">stm</span>(sparse_docs,</span>
<span id="cb38-186"><a href="#cb38-186"></a>                                        <span class="at">prevalence =</span><span class="sc">~</span> year <span class="sc">+</span> main_concept,</span>
<span id="cb38-187"><a href="#cb38-187"></a>                                        <span class="at">data =</span> docs,</span>
<span id="cb38-188"><a href="#cb38-188"></a>                                        <span class="at">gamma.prior =</span> <span class="st">"L1"</span>,</span>
<span id="cb38-189"><a href="#cb38-189"></a>                                        <span class="at">K =</span> .,</span>
<span id="cb38-190"><a href="#cb38-190"></a>                                        <span class="at">verbose =</span> <span class="cn">FALSE</span>),</span>
<span id="cb38-191"><a href="#cb38-191"></a>         <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="dv">42</span>),</span>
<span id="cb38-192"><a href="#cb38-192"></a>         <span class="at">.progress =</span> <span class="cn">TRUE</span>))</span>
<span id="cb38-193"><a href="#cb38-193"></a></span>
<span id="cb38-194"><a href="#cb38-194"></a><span class="in">```</span></span>
<span id="cb38-195"><a href="#cb38-195"></a></span>
<span id="cb38-196"><a href="#cb38-196"></a><span class="fu">## Model Diagnostics</span></span>
<span id="cb38-197"><a href="#cb38-197"></a></span>
<span id="cb38-200"><a href="#cb38-200"></a><span class="in">```{r}</span></span>
<span id="cb38-201"><a href="#cb38-201"></a><span class="co">#| label: model diagnostics</span></span>
<span id="cb38-202"><a href="#cb38-202"></a><span class="co">#| message: false</span></span>
<span id="cb38-203"><a href="#cb38-203"></a></span>
<span id="cb38-204"><a href="#cb38-204"></a><span class="co"># make heldout</span></span>
<span id="cb38-205"><a href="#cb38-205"></a>heldout <span class="ot">&lt;-</span> <span class="fu">make.heldout</span>(sparse_docs, <span class="at">seed =</span> <span class="dv">42</span>)</span>
<span id="cb38-206"><a href="#cb38-206"></a></span>
<span id="cb38-207"><a href="#cb38-207"></a><span class="co"># calculate diagnostics</span></span>
<span id="cb38-208"><a href="#cb38-208"></a>k_result <span class="ot">&lt;-</span> many_models <span class="sc">%&gt;%</span></span>
<span id="cb38-209"><a href="#cb38-209"></a>  <span class="fu">mutate</span>(<span class="at">exclusivity =</span> <span class="fu">map</span>(topic_model, exclusivity),</span>
<span id="cb38-210"><a href="#cb38-210"></a>         <span class="at">semantic_coherence =</span> <span class="fu">map</span>(topic_model, semanticCoherence, sparse_docs),</span>
<span id="cb38-211"><a href="#cb38-211"></a>         <span class="at">eval_heldout =</span> <span class="fu">map</span>(topic_model, eval.heldout, heldout<span class="sc">$</span>missing),</span>
<span id="cb38-212"><a href="#cb38-212"></a>         <span class="at">residual =</span> <span class="fu">map</span>(topic_model, checkResiduals, sparse_docs),</span>
<span id="cb38-213"><a href="#cb38-213"></a>         <span class="at">bound =</span>  <span class="fu">map_dbl</span>(topic_model, <span class="cf">function</span>(x) <span class="fu">max</span>(x<span class="sc">$</span>convergence<span class="sc">$</span>bound)),</span>
<span id="cb38-214"><a href="#cb38-214"></a>         <span class="at">lfact =</span> <span class="fu">map_dbl</span>(topic_model, <span class="cf">function</span>(x) <span class="fu">lfactorial</span>(x<span class="sc">$</span>settings<span class="sc">$</span>dim<span class="sc">$</span>K)),</span>
<span id="cb38-215"><a href="#cb38-215"></a>         <span class="at">lbound =</span> bound <span class="sc">+</span> lfact,</span>
<span id="cb38-216"><a href="#cb38-216"></a>         <span class="at">iterations =</span> <span class="fu">map_dbl</span>(topic_model, <span class="cf">function</span>(x) <span class="fu">length</span>(x<span class="sc">$</span>convergence<span class="sc">$</span>bound)))</span>
<span id="cb38-217"><a href="#cb38-217"></a></span>
<span id="cb38-218"><a href="#cb38-218"></a><span class="co"># plot diagnostics</span></span>
<span id="cb38-219"><a href="#cb38-219"></a>k_result <span class="sc">%&gt;%</span></span>
<span id="cb38-220"><a href="#cb38-220"></a>  <span class="fu">transmute</span>(K,</span>
<span id="cb38-221"><a href="#cb38-221"></a>            <span class="st">`</span><span class="at">Lower bound</span><span class="st">`</span> <span class="ot">=</span> lbound,</span>
<span id="cb38-222"><a href="#cb38-222"></a>            <span class="at">Residuals =</span> <span class="fu">map_dbl</span>(residual, <span class="st">"dispersion"</span>),</span>
<span id="cb38-223"><a href="#cb38-223"></a>            <span class="st">`</span><span class="at">Semantic coherence</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">map_dbl</span>(semantic_coherence, mean),</span>
<span id="cb38-224"><a href="#cb38-224"></a>            <span class="st">`</span><span class="at">Held-out likelihood</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">map_dbl</span>(eval_heldout, <span class="st">"expected.heldout"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-225"><a href="#cb38-225"></a>  <span class="fu">gather</span>(Metric, Value, <span class="sc">-</span>K) <span class="sc">%&gt;%</span></span>
<span id="cb38-226"><a href="#cb38-226"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(K, Value)) <span class="sc">+</span></span>
<span id="cb38-227"><a href="#cb38-227"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-228"><a href="#cb38-228"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Metric, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb38-229"><a href="#cb38-229"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"K (number of topics)"</span>,</span>
<span id="cb38-230"><a href="#cb38-230"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb38-231"><a href="#cb38-231"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb38-232"><a href="#cb38-232"></a></span>
<span id="cb38-233"><a href="#cb38-233"></a><span class="co"># define range to check for exclusivity and semantic coherence</span></span>
<span id="cb38-234"><a href="#cb38-234"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb38-235"><a href="#cb38-235"></a></span>
<span id="cb38-236"><a href="#cb38-236"></a><span class="co"># calculate exclusivity and semantic coherence</span></span>
<span id="cb38-237"><a href="#cb38-237"></a>group_means <span class="ot">&lt;-</span> k_result <span class="sc">%&gt;%</span></span>
<span id="cb38-238"><a href="#cb38-238"></a>  <span class="fu">select</span>(K, exclusivity, semantic_coherence) <span class="sc">%&gt;%</span></span>
<span id="cb38-239"><a href="#cb38-239"></a>  <span class="fu">filter</span>(K <span class="sc">%in%</span> range) <span class="sc">%&gt;%</span></span>
<span id="cb38-240"><a href="#cb38-240"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(exclusivity, semantic_coherence)) <span class="sc">%&gt;%</span></span>
<span id="cb38-241"><a href="#cb38-241"></a>  <span class="fu">mutate</span>(<span class="at">K =</span> <span class="fu">as.factor</span>(K)) <span class="sc">%&gt;%</span></span>
<span id="cb38-242"><a href="#cb38-242"></a>  <span class="fu">group_by</span>(K) <span class="sc">%&gt;%</span></span>
<span id="cb38-243"><a href="#cb38-243"></a>  <span class="fu">summarise</span>(</span>
<span id="cb38-244"><a href="#cb38-244"></a>    <span class="at">exclusivity =</span> <span class="fu">mean</span>(exclusivity),</span>
<span id="cb38-245"><a href="#cb38-245"></a>    <span class="at">semantic_coherence =</span> <span class="fu">mean</span>(semantic_coherence)</span>
<span id="cb38-246"><a href="#cb38-246"></a>  )</span>
<span id="cb38-247"><a href="#cb38-247"></a></span>
<span id="cb38-248"><a href="#cb38-248"></a><span class="co"># plot semantic coherence and exclusivity</span></span>
<span id="cb38-249"><a href="#cb38-249"></a>k_result <span class="sc">%&gt;%</span></span>
<span id="cb38-250"><a href="#cb38-250"></a>  <span class="fu">select</span>(K, exclusivity, semantic_coherence) <span class="sc">%&gt;%</span></span>
<span id="cb38-251"><a href="#cb38-251"></a>  <span class="fu">filter</span>(K <span class="sc">%in%</span> range) <span class="sc">%&gt;%</span></span>
<span id="cb38-252"><a href="#cb38-252"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(exclusivity, semantic_coherence)) <span class="sc">%&gt;%</span></span>
<span id="cb38-253"><a href="#cb38-253"></a>  <span class="fu">mutate</span>(<span class="at">K =</span> <span class="fu">as.factor</span>(K)) <span class="sc">%&gt;%</span></span>
<span id="cb38-254"><a href="#cb38-254"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(semantic_coherence, exclusivity, <span class="at">z =</span> K, <span class="at">color =</span> K)) <span class="sc">+</span></span>
<span id="cb38-255"><a href="#cb38-255"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb38-256"><a href="#cb38-256"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> group_means, <span class="at">label =</span> group_means<span class="sc">$</span>K, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-257"><a href="#cb38-257"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Semantic coherence"</span>,</span>
<span id="cb38-258"><a href="#cb38-258"></a>       <span class="at">y =</span> <span class="st">"Exclusivity"</span>) <span class="sc">+</span></span>
<span id="cb38-259"><a href="#cb38-259"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb38-260"><a href="#cb38-260"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb38-261"><a href="#cb38-261"></a>  <span class="fu">scale_color_grey</span>(<span class="at">start =</span> .<span class="dv">5</span>, <span class="at">end =</span> <span class="dv">0</span>)</span>
<span id="cb38-262"><a href="#cb38-262"></a></span>
<span id="cb38-263"><a href="#cb38-263"></a><span class="co"># extract k = 14 model</span></span>
<span id="cb38-264"><a href="#cb38-264"></a>topic_model <span class="ot">&lt;-</span> k_result <span class="sc">%&gt;%</span> </span>
<span id="cb38-265"><a href="#cb38-265"></a>  <span class="fu">filter</span>(K <span class="sc">==</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-266"><a href="#cb38-266"></a>  <span class="fu">pull</span>(topic_model) <span class="sc">%&gt;%</span> </span>
<span id="cb38-267"><a href="#cb38-267"></a>  .[[<span class="dv">1</span>]]</span>
<span id="cb38-268"><a href="#cb38-268"></a></span>
<span id="cb38-269"><a href="#cb38-269"></a>topic_model</span>
<span id="cb38-270"><a href="#cb38-270"></a></span>
<span id="cb38-271"><a href="#cb38-271"></a><span class="in">```</span></span>
<span id="cb38-272"><a href="#cb38-272"></a></span>
<span id="cb38-273"><a href="#cb38-273"></a><span class="fu">## Inspect Model</span></span>
<span id="cb38-274"><a href="#cb38-274"></a></span>
<span id="cb38-277"><a href="#cb38-277"></a><span class="in">```{r}</span></span>
<span id="cb38-278"><a href="#cb38-278"></a><span class="co">#| label: inspect model</span></span>
<span id="cb38-279"><a href="#cb38-279"></a><span class="co">#| message: false</span></span>
<span id="cb38-280"><a href="#cb38-280"></a><span class="co">#| fig-width: 15</span></span>
<span id="cb38-281"><a href="#cb38-281"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb38-282"><a href="#cb38-282"></a><span class="co">#| column: page</span></span>
<span id="cb38-283"><a href="#cb38-283"></a></span>
<span id="cb38-284"><a href="#cb38-284"></a><span class="co"># beta (probabilities that each word is generated from each topic)</span></span>
<span id="cb38-285"><a href="#cb38-285"></a>td_beta <span class="ot">&lt;-</span> <span class="fu">tidy</span>(topic_model)</span>
<span id="cb38-286"><a href="#cb38-286"></a>td_beta</span>
<span id="cb38-287"><a href="#cb38-287"></a></span>
<span id="cb38-288"><a href="#cb38-288"></a><span class="co"># gamma (probabilities that each document is generated from each topic)</span></span>
<span id="cb38-289"><a href="#cb38-289"></a>td_gamma <span class="ot">&lt;-</span> <span class="fu">tidy</span>(topic_model, <span class="at">matrix =</span> <span class="st">"gamma"</span>,</span>
<span id="cb38-290"><a href="#cb38-290"></a>                 <span class="at">document_names =</span> <span class="fu">rownames</span>(sparse_docs))</span>
<span id="cb38-291"><a href="#cb38-291"></a>td_gamma</span>
<span id="cb38-292"><a href="#cb38-292"></a></span>
<span id="cb38-293"><a href="#cb38-293"></a><span class="co"># top terms</span></span>
<span id="cb38-294"><a href="#cb38-294"></a>top_terms <span class="ot">&lt;-</span> td_beta <span class="sc">%&gt;%</span></span>
<span id="cb38-295"><a href="#cb38-295"></a>  <span class="fu">arrange</span>(beta) <span class="sc">%&gt;%</span></span>
<span id="cb38-296"><a href="#cb38-296"></a>  <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb38-297"><a href="#cb38-297"></a>  <span class="fu">top_n</span>(<span class="dv">20</span>, beta) <span class="sc">%&gt;%</span></span>
<span id="cb38-298"><a href="#cb38-298"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>beta) <span class="sc">%&gt;%</span></span>
<span id="cb38-299"><a href="#cb38-299"></a>  <span class="fu">select</span>(topic, term) <span class="sc">%&gt;%</span></span>
<span id="cb38-300"><a href="#cb38-300"></a>  <span class="fu">summarise</span>(<span class="at">terms =</span> <span class="fu">list</span>(term)) <span class="sc">%&gt;%</span></span>
<span id="cb38-301"><a href="#cb38-301"></a>  <span class="fu">mutate</span>(<span class="at">terms =</span> <span class="fu">map</span>(terms, paste, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-302"><a href="#cb38-302"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(terms))</span>
<span id="cb38-303"><a href="#cb38-303"></a></span>
<span id="cb38-304"><a href="#cb38-304"></a>top_terms</span>
<span id="cb38-305"><a href="#cb38-305"></a></span>
<span id="cb38-306"><a href="#cb38-306"></a><span class="co"># top gamma terms</span></span>
<span id="cb38-307"><a href="#cb38-307"></a>gamma_terms <span class="ot">&lt;-</span> td_gamma <span class="sc">%&gt;%</span></span>
<span id="cb38-308"><a href="#cb38-308"></a>  <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb38-309"><a href="#cb38-309"></a>  <span class="fu">summarise</span>(<span class="at">gamma =</span> <span class="fu">mean</span>(gamma)) <span class="sc">%&gt;%</span></span>
<span id="cb38-310"><a href="#cb38-310"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(gamma)) <span class="sc">%&gt;%</span></span>
<span id="cb38-311"><a href="#cb38-311"></a>  <span class="fu">left_join</span>(top_terms, <span class="at">by =</span> <span class="st">"topic"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-312"><a href="#cb38-312"></a>  <span class="fu">mutate</span>(<span class="at">topic =</span> <span class="fu">paste0</span>(<span class="st">"Topic "</span>, topic),</span>
<span id="cb38-313"><a href="#cb38-313"></a>         <span class="at">topic =</span> <span class="fu">reorder</span>(topic, gamma))</span>
<span id="cb38-314"><a href="#cb38-314"></a></span>
<span id="cb38-315"><a href="#cb38-315"></a>gamma_terms</span>
<span id="cb38-316"><a href="#cb38-316"></a></span>
<span id="cb38-317"><a href="#cb38-317"></a><span class="co"># plot top gamma terms</span></span>
<span id="cb38-318"><a href="#cb38-318"></a>gamma_terms <span class="sc">%&gt;%</span></span>
<span id="cb38-319"><a href="#cb38-319"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(topic, gamma, <span class="at">label =</span> <span class="fu">str_wrap</span>(terms, <span class="at">width =</span> <span class="dv">170</span>))) <span class="sc">+</span></span>
<span id="cb38-320"><a href="#cb38-320"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-321"><a href="#cb38-321"></a>  <span class="fu">geom_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">nudge_y =</span> <span class="fl">0.005</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb38-322"><a href="#cb38-322"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb38-323"><a href="#cb38-323"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb38-324"><a href="#cb38-324"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="fu">expression</span>(gamma)) <span class="sc">+</span> </span>
<span id="cb38-325"><a href="#cb38-325"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb38-326"><a href="#cb38-326"></a></span>
<span id="cb38-327"><a href="#cb38-327"></a><span class="co"># get top topic (highest probability) per doc</span></span>
<span id="cb38-328"><a href="#cb38-328"></a>top_classification <span class="ot">&lt;-</span> td_gamma <span class="sc">%&gt;%</span> </span>
<span id="cb38-329"><a href="#cb38-329"></a>  <span class="fu">group_by</span>(document) <span class="sc">%&gt;%</span> </span>
<span id="cb38-330"><a href="#cb38-330"></a>  <span class="fu">top_n</span>(<span class="dv">1</span>, gamma) <span class="sc">%&gt;%</span></span>
<span id="cb38-331"><a href="#cb38-331"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-332"><a href="#cb38-332"></a>  <span class="fu">mutate</span>(<span class="at">doc_id =</span> <span class="fu">as.numeric</span>(document))</span>
<span id="cb38-333"><a href="#cb38-333"></a></span>
<span id="cb38-334"><a href="#cb38-334"></a>top_classification</span>
<span id="cb38-335"><a href="#cb38-335"></a></span>
<span id="cb38-336"><a href="#cb38-336"></a><span class="co"># add top topic (highest probability) to docs</span></span>
<span id="cb38-337"><a href="#cb38-337"></a>topic_docs <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(docs, top_classification) <span class="sc">%&gt;%</span></span>
<span id="cb38-338"><a href="#cb38-338"></a>  <span class="fu">relocate</span>(topic, gamma, <span class="at">.after =</span> doc_id)</span>
<span id="cb38-339"><a href="#cb38-339"></a></span>
<span id="cb38-340"><a href="#cb38-340"></a><span class="co"># get top concepts by topic</span></span>
<span id="cb38-341"><a href="#cb38-341"></a>top_topic_concepts <span class="ot">&lt;-</span> topic_docs <span class="sc">%&gt;%</span> </span>
<span id="cb38-342"><a href="#cb38-342"></a>  <span class="fu">select</span>(<span class="sc">-</span>concept_id, <span class="sc">-</span>concept_score, <span class="sc">-</span>concept_lecel, <span class="sc">-</span>concept_url) <span class="sc">%&gt;%</span> </span>
<span id="cb38-343"><a href="#cb38-343"></a>  <span class="fu">unnest</span>(all_concepts) <span class="sc">%&gt;%</span> </span>
<span id="cb38-344"><a href="#cb38-344"></a>  <span class="fu">filter</span>(concept_name <span class="sc">!=</span> <span class="st">"Autonomy"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-345"><a href="#cb38-345"></a>  <span class="fu">group_by</span>(doc_id, topic) <span class="sc">%&gt;%</span> </span>
<span id="cb38-346"><a href="#cb38-346"></a>  <span class="fu">arrange</span>(concept_lecel, <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-347"><a href="#cb38-347"></a>  <span class="fu">group_by</span>(topic, concept_name) <span class="sc">%&gt;%</span> </span>
<span id="cb38-348"><a href="#cb38-348"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb38-349"><a href="#cb38-349"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n), <span class="at">.by_group =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-350"><a href="#cb38-350"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-351"><a href="#cb38-351"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-352"><a href="#cb38-352"></a>    <span class="at">top_topic_concepts =</span> <span class="fu">str_flatten</span>(concept_name, <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb38-353"><a href="#cb38-353"></a>    <span class="at">topic =</span> <span class="fu">str_c</span>(<span class="st">"Topic "</span>, topic) <span class="sc">%&gt;%</span> <span class="fu">as_factor</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb38-354"><a href="#cb38-354"></a>  <span class="fu">nest</span>(<span class="at">all_concepts =</span> <span class="fu">c</span>(concept_name, n))</span>
<span id="cb38-355"><a href="#cb38-355"></a></span>
<span id="cb38-356"><a href="#cb38-356"></a>top_topic_concepts <span class="ot">&lt;-</span> <span class="fu">left_join</span>(gamma_terms, top_topic_concepts)</span>
<span id="cb38-357"><a href="#cb38-357"></a></span>
<span id="cb38-358"><a href="#cb38-358"></a><span class="co"># add manual topic labels after inspecting concepts and top words</span></span>
<span id="cb38-359"><a href="#cb38-359"></a>topic_labels <span class="ot">&lt;-</span> </span>
<span id="cb38-360"><a href="#cb38-360"></a>  <span class="fu">tribble</span>(</span>
<span id="cb38-361"><a href="#cb38-361"></a>    <span class="sc">~</span> topic, <span class="sc">~</span> label,</span>
<span id="cb38-362"><a href="#cb38-362"></a>    <span class="st">"Topic 1"</span>, <span class="st">"Adolescence"</span>,</span>
<span id="cb38-363"><a href="#cb38-363"></a>    <span class="st">"Topic 2"</span>, <span class="st">"Digital Policy"</span>,</span>
<span id="cb38-364"><a href="#cb38-364"></a>    <span class="st">"Topic 3"</span>, <span class="st">"Digital Policy"</span>,</span>
<span id="cb38-365"><a href="#cb38-365"></a>    <span class="st">"Topic 4"</span>, <span class="st">"Digital Pedagogy"</span>,</span>
<span id="cb38-366"><a href="#cb38-366"></a>    <span class="st">"Topic 5"</span>, <span class="st">"Digital Workplace"</span>,</span>
<span id="cb38-367"><a href="#cb38-367"></a>    <span class="st">"Topic 6"</span>, <span class="st">"Digital Pedagogy"</span>,</span>
<span id="cb38-368"><a href="#cb38-368"></a>    <span class="st">"Topic 7"</span>, <span class="st">"Digital Media Use"</span>,</span>
<span id="cb38-369"><a href="#cb38-369"></a>    <span class="st">"Topic 8"</span>, <span class="st">"Digital Media Use"</span>,</span>
<span id="cb38-370"><a href="#cb38-370"></a>    <span class="st">"Topic 9"</span>, <span class="st">"Digital Healthcare"</span>,</span>
<span id="cb38-371"><a href="#cb38-371"></a>    <span class="st">"Topic 10"</span>, <span class="st">"Digital Power Structures"</span>,</span>
<span id="cb38-372"><a href="#cb38-372"></a>    <span class="st">"Topic 11"</span>, <span class="st">"Machine Autonomy"</span>,</span>
<span id="cb38-373"><a href="#cb38-373"></a>    <span class="st">"Topic 12"</span>, <span class="st">"Digital Policy"</span>,</span>
<span id="cb38-374"><a href="#cb38-374"></a>    <span class="st">"Topic 13"</span>, <span class="st">"Digital Pedagogy"</span>,</span>
<span id="cb38-375"><a href="#cb38-375"></a>    <span class="st">"Topic 14"</span>, <span class="st">"Machine Autonomy"</span>,</span>
<span id="cb38-376"><a href="#cb38-376"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb38-377"><a href="#cb38-377"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-378"><a href="#cb38-378"></a>    <span class="at">topic =</span> <span class="fu">as.factor</span>(topic),</span>
<span id="cb38-379"><a href="#cb38-379"></a>    <span class="at">label =</span> <span class="fu">as.factor</span>(label)</span>
<span id="cb38-380"><a href="#cb38-380"></a>  )</span>
<span id="cb38-381"><a href="#cb38-381"></a></span>
<span id="cb38-382"><a href="#cb38-382"></a><span class="co"># order by sum of gamma by manual topic</span></span>
<span id="cb38-383"><a href="#cb38-383"></a>top_topic_concepts_plot <span class="ot">&lt;-</span> <span class="fu">left_join</span>(top_topic_concepts, topic_labels) <span class="sc">%&gt;%</span> </span>
<span id="cb38-384"><a href="#cb38-384"></a>  <span class="fu">group_by</span>(label) <span class="sc">%&gt;%</span> </span>
<span id="cb38-385"><a href="#cb38-385"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-386"><a href="#cb38-386"></a>    <span class="at">order =</span> <span class="fu">sum</span>(gamma)</span>
<span id="cb38-387"><a href="#cb38-387"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb38-388"><a href="#cb38-388"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb38-389"><a href="#cb38-389"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">fct_reorder</span>(label, order, <span class="at">.desc =</span> <span class="cn">TRUE</span>))</span>
<span id="cb38-390"><a href="#cb38-390"></a></span>
<span id="cb38-391"><a href="#cb38-391"></a><span class="co"># plot  </span></span>
<span id="cb38-392"><a href="#cb38-392"></a>p1 <span class="ot">&lt;-</span> top_topic_concepts_plot <span class="sc">%&gt;%</span> </span>
<span id="cb38-393"><a href="#cb38-393"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(topic, gamma)) <span class="sc">+</span></span>
<span id="cb38-394"><a href="#cb38-394"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-395"><a href="#cb38-395"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb38-396"><a href="#cb38-396"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(),</span>
<span id="cb38-397"><a href="#cb38-397"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">15</span>), <span class="at">position =</span> <span class="st">"right"</span>,</span>
<span id="cb38-398"><a href="#cb38-398"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">05</span>, .<span class="dv">1</span>, .<span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb38-399"><a href="#cb38-399"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="fu">expression</span>(gamma <span class="sc">~</span> <span class="st">" (Topic Prevalence)"</span>)) <span class="sc">+</span> </span>
<span id="cb38-400"><a href="#cb38-400"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(label), <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">space =</span> <span class="st">"free_y"</span>,</span>
<span id="cb38-401"><a href="#cb38-401"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">label =</span> <span class="fu">label_wrap_gen</span>(<span class="dv">10</span>)),</span>
<span id="cb38-402"><a href="#cb38-402"></a>             <span class="at">switch =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb38-403"><a href="#cb38-403"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb38-404"><a href="#cb38-404"></a>  <span class="fu">theme</span>(<span class="at">strip.text.y.left =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb38-405"><a href="#cb38-405"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-406"><a href="#cb38-406"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>())</span>
<span id="cb38-407"><a href="#cb38-407"></a></span>
<span id="cb38-408"><a href="#cb38-408"></a>p2 <span class="ot">&lt;-</span> top_topic_concepts_plot <span class="sc">%&gt;%</span> </span>
<span id="cb38-409"><a href="#cb38-409"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(topic, gamma)) <span class="sc">+</span></span>
<span id="cb38-410"><a href="#cb38-410"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_wrap</span>(terms, <span class="at">width =</span> <span class="dv">120</span>), <span class="at">y =</span> <span class="dv">0</span>), <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb38-411"><a href="#cb38-411"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb38-412"><a href="#cb38-412"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb38-413"><a href="#cb38-413"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(label), <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">space =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb38-414"><a href="#cb38-414"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb38-415"><a href="#cb38-415"></a>  <span class="fu">ylab</span>(<span class="st">"Top Words"</span>) <span class="sc">+</span></span>
<span id="cb38-416"><a href="#cb38-416"></a>  <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-417"><a href="#cb38-417"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"#ffffff"</span>),</span>
<span id="cb38-418"><a href="#cb38-418"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"#ffffff"</span>),</span>
<span id="cb38-419"><a href="#cb38-419"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-420"><a href="#cb38-420"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-421"><a href="#cb38-421"></a>        <span class="at">strip.background.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-422"><a href="#cb38-422"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-423"><a href="#cb38-423"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-424"><a href="#cb38-424"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>())</span>
<span id="cb38-425"><a href="#cb38-425"></a></span>
<span id="cb38-426"><a href="#cb38-426"></a>p3 <span class="ot">&lt;-</span> top_topic_concepts_plot <span class="sc">%&gt;%</span> </span>
<span id="cb38-427"><a href="#cb38-427"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(topic, gamma)) <span class="sc">+</span></span>
<span id="cb38-428"><a href="#cb38-428"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_wrap</span>(<span class="fu">str_to_lower</span>(top_topic_concepts), <span class="at">width =</span> <span class="dv">45</span>), <span class="at">y =</span> <span class="dv">0</span>),</span>
<span id="cb38-429"><a href="#cb38-429"></a>            <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb38-430"><a href="#cb38-430"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb38-431"><a href="#cb38-431"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb38-432"><a href="#cb38-432"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(label), <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">space =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb38-433"><a href="#cb38-433"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb38-434"><a href="#cb38-434"></a>  <span class="fu">ylab</span>(<span class="st">"Top Concepts"</span>) <span class="sc">+</span></span>
<span id="cb38-435"><a href="#cb38-435"></a>  <span class="fu">theme</span>(<span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-436"><a href="#cb38-436"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"#ffffff"</span>),</span>
<span id="cb38-437"><a href="#cb38-437"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-438"><a href="#cb38-438"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-439"><a href="#cb38-439"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-440"><a href="#cb38-440"></a>        <span class="at">strip.background.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-441"><a href="#cb38-441"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-442"><a href="#cb38-442"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-443"><a href="#cb38-443"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>())</span>
<span id="cb38-444"><a href="#cb38-444"></a></span>
<span id="cb38-445"><a href="#cb38-445"></a><span class="fu">ggarrange</span>(p1, p2, p3,</span>
<span id="cb38-446"><a href="#cb38-446"></a>          <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb38-447"><a href="#cb38-447"></a>          <span class="at">widths =</span> <span class="fu">c</span>(.<span class="dv">6</span> , <span class="fl">1.7</span>, .<span class="dv">7</span>))</span>
<span id="cb38-448"><a href="#cb38-448"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>